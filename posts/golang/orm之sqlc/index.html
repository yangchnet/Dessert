<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>ORM之sqlc | Linote</title><meta name=keywords content="golang,ORM,sqlc"><meta name=description content="1. 安装sqlc go get github.com/kyleconroy/sqlc/cmd/sqlc 2. 基本使用 建立基本项目结构 mkdir sqlc-demo cd sqlc-demo go mod init sqlc-demo 在sqlc-demo中建立如下目录结构：
. ├── db │ ├── queries │ ├── schema │ └── sqlc └── go.mod 其中query中存储查询语句，schema中存储数据库表结构，sqlc中存储生成的代码。
基本表结构  sqlc-demo/db/schema/table.sql
 CREATE TABLE &#34;accounts&#34; ( &#34;id&#34; bigserial PRIMARY KEY, &#34;owner&#34; varchar NOT NULL, &#34;balance&#34; bigint NOT NULL, &#34;currency&#34; varchar NOT NULL, &#34;created_at&#34; timestamptz NOT NULL DEFAULT (now()) ); CREATE TABLE &#34;entries&#34; ( &#34;id&#34; bigserial PRIMARY KEY, &#34;account_id&#34; bigint NOT NULL, &#34;amount&#34; bigint NOT NULL, &#34;created_at&#34; timestamptz NOT NULL DEFAULT (now()) ); CREATE TABLE &#34;transfers&#34; ( &#34;id&#34; bigserial PRIMARY KEY, &#34;from_account_id&#34; bigint NOT NULL, &#34;to_account_id&#34; bigint NOT NULL, &#34;amount&#34; bigint NOT NULL, &#34;created_at&#34; timestamptz NOT NULL DEFAULT (now()) ); 配置文件  sqlc-demo/sqlc."><meta name=author content="李昌"><link rel=canonical href=http://yangchnet.github.io/Dessert/posts/golang/orm%E4%B9%8Bsqlc/><link crossorigin=anonymous href=/Dessert/assets/css/stylesheet.min.2d6dbfc6e0f8a1db1c9d082a76dc11d094328cf63f247bbc2421dfaa7f2bb170.css integrity="sha256-LW2/xuD4odscnQgqdtwR0JQyjPY/JHu8JCHfqn8rsXA=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/Dessert/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://raw.githubusercontent.com/lich-Img/blogImg/master/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://raw.githubusercontent.com/lich-Img/blogImg/master/favicon.ico><link rel=icon type=image/png sizes=32x32 href=https://raw.githubusercontent.com/lich-Img/blogImg/master/favicon32.ico><link rel=apple-touch-icon href=http://yangchnet.github.io/Dessert/apple-touch-icon.png><link rel=mask-icon href=http://yangchnet.github.io/Dessert/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.81.0"><meta property="og:title" content="ORM之sqlc"><meta property="og:description" content="1. 安装sqlc go get github.com/kyleconroy/sqlc/cmd/sqlc 2. 基本使用 建立基本项目结构 mkdir sqlc-demo cd sqlc-demo go mod init sqlc-demo 在sqlc-demo中建立如下目录结构：
. ├── db │ ├── queries │ ├── schema │ └── sqlc └── go.mod 其中query中存储查询语句，schema中存储数据库表结构，sqlc中存储生成的代码。
基本表结构  sqlc-demo/db/schema/table.sql
 CREATE TABLE &#34;accounts&#34; ( &#34;id&#34; bigserial PRIMARY KEY, &#34;owner&#34; varchar NOT NULL, &#34;balance&#34; bigint NOT NULL, &#34;currency&#34; varchar NOT NULL, &#34;created_at&#34; timestamptz NOT NULL DEFAULT (now()) ); CREATE TABLE &#34;entries&#34; ( &#34;id&#34; bigserial PRIMARY KEY, &#34;account_id&#34; bigint NOT NULL, &#34;amount&#34; bigint NOT NULL, &#34;created_at&#34; timestamptz NOT NULL DEFAULT (now()) ); CREATE TABLE &#34;transfers&#34; ( &#34;id&#34; bigserial PRIMARY KEY, &#34;from_account_id&#34; bigint NOT NULL, &#34;to_account_id&#34; bigint NOT NULL, &#34;amount&#34; bigint NOT NULL, &#34;created_at&#34; timestamptz NOT NULL DEFAULT (now()) ); 配置文件  sqlc-demo/sqlc."><meta property="og:type" content="article"><meta property="og:url" content="http://yangchnet.github.io/Dessert/posts/golang/orm%E4%B9%8Bsqlc/"><meta property="og:image" content="http://yangchnet.github.io/Dessert/papermod-cover.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-08-22T00:00:00+00:00"><meta property="article:modified_time" content="2021-08-22T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://yangchnet.github.io/Dessert/papermod-cover.png"><meta name=twitter:title content="ORM之sqlc"><meta name=twitter:description content="1. 安装sqlc go get github.com/kyleconroy/sqlc/cmd/sqlc 2. 基本使用 建立基本项目结构 mkdir sqlc-demo cd sqlc-demo go mod init sqlc-demo 在sqlc-demo中建立如下目录结构：
. ├── db │ ├── queries │ ├── schema │ └── sqlc └── go.mod 其中query中存储查询语句，schema中存储数据库表结构，sqlc中存储生成的代码。
基本表结构  sqlc-demo/db/schema/table.sql
 CREATE TABLE &#34;accounts&#34; ( &#34;id&#34; bigserial PRIMARY KEY, &#34;owner&#34; varchar NOT NULL, &#34;balance&#34; bigint NOT NULL, &#34;currency&#34; varchar NOT NULL, &#34;created_at&#34; timestamptz NOT NULL DEFAULT (now()) ); CREATE TABLE &#34;entries&#34; ( &#34;id&#34; bigserial PRIMARY KEY, &#34;account_id&#34; bigint NOT NULL, &#34;amount&#34; bigint NOT NULL, &#34;created_at&#34; timestamptz NOT NULL DEFAULT (now()) ); CREATE TABLE &#34;transfers&#34; ( &#34;id&#34; bigserial PRIMARY KEY, &#34;from_account_id&#34; bigint NOT NULL, &#34;to_account_id&#34; bigint NOT NULL, &#34;amount&#34; bigint NOT NULL, &#34;created_at&#34; timestamptz NOT NULL DEFAULT (now()) ); 配置文件  sqlc-demo/sqlc."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"http://yangchnet.github.io/Dessert/posts/"},{"@type":"ListItem","position":3,"name":"ORM之sqlc","item":"http://yangchnet.github.io/Dessert/posts/golang/orm%E4%B9%8Bsqlc/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"ORM之sqlc","name":"ORM之sqlc","description":"1. 安装sqlc go get github.com/kyleconroy/sqlc/cmd/sqlc 2. 基本使用 建立基本项目结构 mkdir sqlc-demo cd sqlc-demo go mod init sqlc-demo 在sqlc-demo中建立如下目录结构：\n. ├── db │ ├── queries │ ├── schema │ └── sqlc └── go.mod 其中query中存储查询语句，schema中存储数据库表结构，sqlc中存储生成的代码。\n基本表结构  sqlc-demo/db/schema/table.sql\n CREATE TABLE \u0026#34;accounts\u0026#34; ( \u0026#34;id\u0026#34; bigserial PRIMARY KEY, \u0026#34;owner\u0026#34; varchar NOT NULL, \u0026#34;balance\u0026#34; bigint NOT NULL, \u0026#34;currency\u0026#34; varchar NOT NULL, \u0026#34;created_at\u0026#34; timestamptz NOT NULL DEFAULT (now()) ); CREATE TABLE \u0026#34;entries\u0026#34; ( \u0026#34;id\u0026#34; bigserial PRIMARY KEY, \u0026#34;account_id\u0026#34; bigint NOT NULL, \u0026#34;amount\u0026#34; bigint NOT NULL, \u0026#34;created_at\u0026#34; timestamptz NOT NULL DEFAULT (now()) ); CREATE TABLE \u0026#34;transfers\u0026#34; ( \u0026#34;id\u0026#34; bigserial PRIMARY KEY, \u0026#34;from_account_id\u0026#34; bigint NOT NULL, \u0026#34;to_account_id\u0026#34; bigint NOT NULL, \u0026#34;amount\u0026#34; bigint NOT NULL, \u0026#34;created_at\u0026#34; timestamptz NOT NULL DEFAULT (now()) ); 配置文件  sqlc-demo/sqlc.","keywords":["golang","ORM","sqlc"],"articleBody":"1. 安装sqlc go get github.com/kyleconroy/sqlc/cmd/sqlc 2. 基本使用 建立基本项目结构 mkdir sqlc-demo cd sqlc-demo go mod init sqlc-demo 在sqlc-demo中建立如下目录结构：\n. ├── db │ ├── queries │ ├── schema │ └── sqlc └── go.mod 其中query中存储查询语句，schema中存储数据库表结构，sqlc中存储生成的代码。\n基本表结构  sqlc-demo/db/schema/table.sql\n CREATE TABLE \"accounts\" ( \"id\" bigserial PRIMARY KEY, \"owner\" varchar NOT NULL, \"balance\" bigint NOT NULL, \"currency\" varchar NOT NULL, \"created_at\" timestamptz NOT NULL DEFAULT (now()) ); CREATE TABLE \"entries\" ( \"id\" bigserial PRIMARY KEY, \"account_id\" bigint NOT NULL, \"amount\" bigint NOT NULL, \"created_at\" timestamptz NOT NULL DEFAULT (now()) ); CREATE TABLE \"transfers\" ( \"id\" bigserial PRIMARY KEY, \"from_account_id\" bigint NOT NULL, \"to_account_id\" bigint NOT NULL, \"amount\" bigint NOT NULL, \"created_at\" timestamptz NOT NULL DEFAULT (now()) ); 配置文件  sqlc-demo/sqlc.yaml\n version: 1 packages: - name: \"db\" # 生成文件的包名  path: \"db/sqlc\" # 生成的文件位置 engine: \"postgresql\" # 数据库驱动引擎 schema: \"./db/schema/\" # 数据库表结构 queries: \"./db/queries\" # 查询语句位置 查询语句 现在有了表结构和配置文件，我们可以开始根据业务需要书写查询语句了。\n sqlc-demo/db/queries/account.sql\n -- name: CreateAccount :one INSERT INTO accounts ( owner, balance, currency ) VALUES ( $1, $2, $3 ) RETURNING *; 在上面这个查询语句中，第一行注释是为sqlc做的标记，告诉sqlc，要生成的函数名字为CreateAccount, 返回单个对象。\n生成代码  sqlc-demo/Makefile\n sqlc: sqlc generate .PHONY: sqlc 查看sqlc-demo/db/sqlc/文件夹下，生成了三个文件：\n. ├── db │ ├── queries │ │ └── account.sql │ ├── schema │ │ └── table.sql │ └── sqlc │ ├── account.sql.go │ ├── db.go │ └── models.go ├── go.mod ├── Makefile └── sqlc.yaml 其中，account.sql.go中包含有生成的CreateAccount函数:\nfunc (q *Queries) CreateAccount(ctx context.Context, arg CreateAccountParams) (Account, error) { row := q.db.QueryRowContext(ctx, createAccount, arg.Owner, arg.Balance, arg.Currency) var i Account err := row.Scan( \u0026i.ID, \u0026i.Owner, \u0026i.Balance, \u0026i.Currency, \u0026i.CreatedAt, ) return i, err } 这样，我们就可以非常方便的通过golang函数调用的方式完成操作数据库的任务。\n使用 func run() error { ctx := context.Background() psql_db, err := sql.Open(\"postgres\", \"user=pqgotest dbname=pqgotest sslmode=verify-full\") if err != nil { return err } queries := db.New(psql_db) // create an author \tinsertedAccount, err := queries.CreateAccount(ctx, db.CreateAccountParams{ Owner: \"name\", Balance: 0, Currency: \"RMB\", }) if err != nil { return err } log.Println(insertedAccount) return nil 3. 注释 要想让sqlc为你生成代码，需要在查询语句的上方写上一行注释，其格式为：\n-- name:   其中, 是你想要生成函数的名字，则是对生成函数的返回做简单的设置\n :exec  :exec使函数只执行查询语句，但不返回任何值（除error外）\n-- name: DeleteAuthor :exec DELETE FROM authors WHERE id = $1; func (q *Queries) DeleteAuthor(ctx context.Context, id int64) error { _, err := q.db.ExecContext(ctx, deleteAuthor, id) return err } :execresult :execresult使函数返回一个sql.Result接口，其接口定义如下：  type Result interface { // LastInsertId returns the integer generated by the database \t// in response to a command. Typically this will be from an \t// \"auto increment\" column when inserting a new row. Not all \t// databases support this feature, and the syntax of such \t// statements varies. \tLastInsertId() (int64, error) // RowsAffected returns the number of rows affected by an \t// update, insert, or delete. Not every database or database \t// driver may support this. \tRowsAffected() (int64, error) } -- name: DeleteAllAuthors :execresult DELETE FROM authors; func (q *Queries) DeleteAllAuthors(ctx context.Context) (sql.Result, error) { return q.db.ExecContext(ctx, deleteAllAuthors) } :execrows :execrows使函数返回受该查询语句影响的行  -- name: DeleteAllAuthors :execrows DELETE FROM authors; func (q *Queries) DeleteAllAuthors(ctx context.Context) (int64, error) { _, err := q.db.ExecContext(ctx, deleteAllAuthors) // ... } :many :many使函数返回一个切片  -- name: ListAuthors :many SELECT * FROM authors ORDER BY name; func (q *Queries) ListAuthors(ctx context.Context) ([]Author, error) { rows, err := q.db.QueryContext(ctx, listAuthors) // ... } :one :one使函数返回单个对象  -- name: GetAuthor :one SELECT * FROM authors WHERE id = $1 LIMIT 1; func (q *Queries) GetAuthor(ctx context.Context, id int64) (Author, error) { row := q.db.QueryRowContext(ctx, getAuthor, id) // ... } 4. 配置文件 version: \"1\" packages: - name: \"db\" # 生成代码的包名 path: \"internal/db\" # 生成代码的位置 queries: \"./sql/query/\" # 查询语句的位置 schema: \"./sql/schema/\" # 数据库表的位置 engine: \"postgresql\" # 数据库引擎 emit_prepared_queries: true # 开启预查询支持，默认为false emit_interface: false # 如果为true，则会生成一个Querier接口，包含所有查询方法，默认为false emit_exact_table_names: false # 如果为true，则结构体会与表名相同，否则将会对复数表名进行单数化，默认为false emit_empty_slices: false # 如果为true，则:many标签若查询为空会返回[]而不是nil, 默认为false emit_exported_queries: false # 如果为true，则生成的函数为可导出的 emit_json_tags: true # 如果为true，则为生成的结构体增加json标签 json_tags_case_style: \"camel\" # json标签的风格，\"camel\"：camelCase，\"pascal\":PascalCase, \"snake\": snake_case output_db_file_name: \"db.go\" # 自定义db文件的名字 output_models_file_name: \"models.go\" # 自定义model文件的名字 output_querier_file_name: \"querier.go\" # 自定义querier文件的名字 ","wordCount":"592","inLanguage":"en","datePublished":"2021-08-22T00:00:00Z","dateModified":"2021-08-22T00:00:00Z","author":{"@type":"Person","name":"李昌"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://yangchnet.github.io/Dessert/posts/golang/orm%E4%B9%8Bsqlc/"},"publisher":{"@type":"Organization","name":"Linote","logo":{"@type":"ImageObject","url":"https://raw.githubusercontent.com/lich-Img/blogImg/master/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script><noscript><style type=text/css>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:#1d1e20;--entry:#2e2e33;--primary:rgba(255, 255, 255, 0.84);--secondary:rgba(255, 255, 255, 0.56);--tertiary:rgba(255, 255, 255, 0.16);--content:rgba(255, 255, 255, 0.74);--hljs-bg:#2e2e33;--code-bg:#37383e;--border:#333}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><header class=header><nav class=nav><div class=logo><a href=http://yangchnet.github.io/Dessert accesskey=h title="Linote (Alt + H)">Linote</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=http://yangchnet.github.io/Dessert/archives/ title=存档><span>存档</span></a></li><li><a href=http://yangchnet.github.io/Dessert/categories/ title=分类><span>分类</span></a></li><li><a href=http://yangchnet.github.io/Dessert/search/ title=搜索><span>搜索</span></a></li><li><a href=http://yangchnet.github.io/Dessert/tags/ title=标签><span>标签</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://yangchnet.github.io/Dessert>Home</a>&nbsp;»&nbsp;<a href=http://yangchnet.github.io/Dessert/posts/>Posts</a></div><h1 class=post-title>ORM之sqlc</h1><div class=post-meta>August 22, 2021&nbsp;·&nbsp;3 min&nbsp;·&nbsp;李昌</div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><div class=details>Table of Contents</div></summary><div class=inner><ul><li><a href=#1-%e5%ae%89%e8%a3%85sqlc aria-label="1. 安装sqlc">1. 安装sqlc</a></li><li><a href=#2-%e5%9f%ba%e6%9c%ac%e4%bd%bf%e7%94%a8 aria-label="2. 基本使用">2. 基本使用</a><ul><ul><ul><li><a href=#%e5%bb%ba%e7%ab%8b%e5%9f%ba%e6%9c%ac%e9%a1%b9%e7%9b%ae%e7%bb%93%e6%9e%84 aria-label=建立基本项目结构>建立基本项目结构</a></li><li><a href=#%e5%9f%ba%e6%9c%ac%e8%a1%a8%e7%bb%93%e6%9e%84 aria-label=基本表结构>基本表结构</a></li><li><a href=#%e9%85%8d%e7%bd%ae%e6%96%87%e4%bb%b6 aria-label=配置文件>配置文件</a></li><li><a href=#%e6%9f%a5%e8%af%a2%e8%af%ad%e5%8f%a5 aria-label=查询语句>查询语句</a></li><li><a href=#%e7%94%9f%e6%88%90%e4%bb%a3%e7%a0%81 aria-label=生成代码>生成代码</a></li><li><a href=#%e4%bd%bf%e7%94%a8 aria-label=使用>使用</a></li></ul></ul></ul></li><li><a href=#3-%e6%b3%a8%e9%87%8a aria-label="3. 注释">3. 注释</a></li><li><a href=#4-%e9%85%8d%e7%bd%ae%e6%96%87%e4%bb%b6 aria-label="4. 配置文件">4. 配置文件</a></li></ul></div></details></div><div class=post-content><h2 id=1-安装sqlc>1. 安装sqlc<a hidden class=anchor aria-hidden=true href=#1-安装sqlc>#</a></h2><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>go get github.com/kyleconroy/sqlc/cmd/sqlc
</code></pre></div><h2 id=2-基本使用>2. 基本使用<a hidden class=anchor aria-hidden=true href=#2-基本使用>#</a></h2><h5 id=建立基本项目结构>建立基本项目结构<a hidden class=anchor aria-hidden=true href=#建立基本项目结构>#</a></h5><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>mkdir sqlc-demo  

cd sqlc-demo

go mod init sqlc-demo
</code></pre></div><p>在<code>sqlc-demo</code>中建立如下目录结构：</p><pre><code>.
├── db
│   ├── queries
│   ├── schema
│   └── sqlc
└── go.mod
</code></pre><p>其中<code>query</code>中存储查询语句，<code>schema</code>中存储数据库表结构，<code>sqlc</code>中存储生成的代码。</p><h5 id=基本表结构>基本表结构<a hidden class=anchor aria-hidden=true href=#基本表结构>#</a></h5><blockquote><p>sqlc-demo/db/schema/table.sql</p></blockquote><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>TABLE</span> <span style=color:#e6db74>&#34;accounts&#34;</span> (
  <span style=color:#e6db74>&#34;id&#34;</span> bigserial <span style=color:#66d9ef>PRIMARY</span> <span style=color:#66d9ef>KEY</span>,
  <span style=color:#e6db74>&#34;owner&#34;</span> varchar <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>,
  <span style=color:#e6db74>&#34;balance&#34;</span> bigint <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>,
  <span style=color:#e6db74>&#34;currency&#34;</span> varchar <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>,
  <span style=color:#e6db74>&#34;created_at&#34;</span> timestamptz <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span> <span style=color:#66d9ef>DEFAULT</span> (now())
);

<span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>TABLE</span> <span style=color:#e6db74>&#34;entries&#34;</span> (
  <span style=color:#e6db74>&#34;id&#34;</span> bigserial <span style=color:#66d9ef>PRIMARY</span> <span style=color:#66d9ef>KEY</span>,
  <span style=color:#e6db74>&#34;account_id&#34;</span> bigint <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>,
  <span style=color:#e6db74>&#34;amount&#34;</span> bigint <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>,
  <span style=color:#e6db74>&#34;created_at&#34;</span> timestamptz <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span> <span style=color:#66d9ef>DEFAULT</span> (now())
);

<span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>TABLE</span> <span style=color:#e6db74>&#34;transfers&#34;</span> (
  <span style=color:#e6db74>&#34;id&#34;</span> bigserial <span style=color:#66d9ef>PRIMARY</span> <span style=color:#66d9ef>KEY</span>,
  <span style=color:#e6db74>&#34;from_account_id&#34;</span> bigint <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>,
  <span style=color:#e6db74>&#34;to_account_id&#34;</span> bigint <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>,
  <span style=color:#e6db74>&#34;amount&#34;</span> bigint <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>,
  <span style=color:#e6db74>&#34;created_at&#34;</span> timestamptz <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span> <span style=color:#66d9ef>DEFAULT</span> (now())
);
</code></pre></div><h5 id=配置文件>配置文件<a hidden class=anchor aria-hidden=true href=#配置文件>#</a></h5><blockquote><p>sqlc-demo/sqlc.yaml</p></blockquote><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#f92672>version</span>: <span style=color:#ae81ff>1</span>
<span style=color:#f92672>packages</span>:
  - <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;db&#34;</span> <span style=color:#75715e># 生成文件的包名 </span>
    <span style=color:#f92672>path</span>: <span style=color:#e6db74>&#34;db/sqlc&#34;</span>  <span style=color:#75715e># 生成的文件位置</span>
    <span style=color:#f92672>engine</span>: <span style=color:#e6db74>&#34;postgresql&#34;</span> <span style=color:#75715e># 数据库驱动引擎</span>
    <span style=color:#f92672>schema</span>: <span style=color:#e6db74>&#34;./db/schema/&#34;</span> <span style=color:#75715e># 数据库表结构</span>
    <span style=color:#f92672>queries</span>: <span style=color:#e6db74>&#34;./db/queries&#34;</span> <span style=color:#75715e># 查询语句位置</span>
</code></pre></div><h5 id=查询语句>查询语句<a hidden class=anchor aria-hidden=true href=#查询语句>#</a></h5><p>现在有了表结构和配置文件，我们可以开始根据业务需要书写查询语句了。</p><blockquote><p>sqlc-demo/db/queries/account.sql</p></blockquote><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#75715e>-- name: CreateAccount :one
</span><span style=color:#75715e></span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> accounts (
  <span style=color:#66d9ef>owner</span>,
  balance,
  currency
) <span style=color:#66d9ef>VALUES</span> (
  <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#ae81ff>1</span>, <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#ae81ff>2</span>, <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#ae81ff>3</span>
) RETURNING <span style=color:#f92672>*</span>;
</code></pre></div><p>在上面这个查询语句中，第一行注释是为<code>sqlc</code>做的标记，告诉<code>sqlc</code>，要生成的函数名字为<code>CreateAccount</code>, 返回单个对象。</p><h5 id=生成代码>生成代码<a hidden class=anchor aria-hidden=true href=#生成代码>#</a></h5><blockquote><p>sqlc-demo/Makefile</p></blockquote><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-makefile data-lang=makefile><span style=color:#a6e22e>sqlc</span><span style=color:#f92672>:</span>
    sqlc generate

<span style=color:#a6e22e>.PHONY</span><span style=color:#f92672>:</span> sqlc
</code></pre></div><p>查看<code>sqlc-demo/db/sqlc/</code>文件夹下，生成了三个文件：</p><pre><code>.
├── db
│   ├── queries
│   │   └── account.sql
│   ├── schema
│   │   └── table.sql
│   └── sqlc
│       ├── account.sql.go
│       ├── db.go
│       └── models.go
├── go.mod
├── Makefile
└── sqlc.yaml
</code></pre><p>其中，<code>account.sql.go</code>中包含有生成的<code>CreateAccount</code>函数:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>q</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>Queries</span>) <span style=color:#a6e22e>CreateAccount</span>(<span style=color:#a6e22e>ctx</span> <span style=color:#a6e22e>context</span>.<span style=color:#a6e22e>Context</span>, <span style=color:#a6e22e>arg</span> <span style=color:#a6e22e>CreateAccountParams</span>) (<span style=color:#a6e22e>Account</span>, <span style=color:#66d9ef>error</span>) {
        <span style=color:#a6e22e>row</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>q</span>.<span style=color:#a6e22e>db</span>.<span style=color:#a6e22e>QueryRowContext</span>(<span style=color:#a6e22e>ctx</span>, <span style=color:#a6e22e>createAccount</span>, <span style=color:#a6e22e>arg</span>.<span style=color:#a6e22e>Owner</span>, <span style=color:#a6e22e>arg</span>.<span style=color:#a6e22e>Balance</span>, <span style=color:#a6e22e>arg</span>.<span style=color:#a6e22e>Currency</span>)
        <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>i</span> <span style=color:#a6e22e>Account</span>
        <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>row</span>.<span style=color:#a6e22e>Scan</span>(
                <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>i</span>.<span style=color:#a6e22e>ID</span>,
                <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>i</span>.<span style=color:#a6e22e>Owner</span>,
                <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>i</span>.<span style=color:#a6e22e>Balance</span>,
                <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>i</span>.<span style=color:#a6e22e>Currency</span>,
                <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>i</span>.<span style=color:#a6e22e>CreatedAt</span>,
        )
        <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>err</span>
}
</code></pre></div><p>这样，我们就可以非常方便的通过golang函数调用的方式完成操作数据库的任务。</p><h5 id=使用>使用<a hidden class=anchor aria-hidden=true href=#使用>#</a></h5><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>run</span>() <span style=color:#66d9ef>error</span> {
	<span style=color:#a6e22e>ctx</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>context</span>.<span style=color:#a6e22e>Background</span>()

	<span style=color:#a6e22e>psql_db</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>sql</span>.<span style=color:#a6e22e>Open</span>(<span style=color:#e6db74>&#34;postgres&#34;</span>, <span style=color:#e6db74>&#34;user=pqgotest dbname=pqgotest sslmode=verify-full&#34;</span>)
	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
		<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>err</span>
	}

	<span style=color:#a6e22e>queries</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>db</span>.<span style=color:#a6e22e>New</span>(<span style=color:#a6e22e>psql_db</span>)

	<span style=color:#75715e>// create an author
</span><span style=color:#75715e></span>	<span style=color:#a6e22e>insertedAccount</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>queries</span>.<span style=color:#a6e22e>CreateAccount</span>(<span style=color:#a6e22e>ctx</span>, <span style=color:#a6e22e>db</span>.<span style=color:#a6e22e>CreateAccountParams</span>{
		<span style=color:#a6e22e>Owner</span>: <span style=color:#e6db74>&#34;name&#34;</span>,
        <span style=color:#a6e22e>Balance</span>: <span style=color:#ae81ff>0</span>,
        <span style=color:#a6e22e>Currency</span>: <span style=color:#e6db74>&#34;RMB&#34;</span>,
	})
	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
		<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>err</span>
	}
	<span style=color:#a6e22e>log</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#a6e22e>insertedAccount</span>)
    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>nil</span>
</code></pre></div><h2 id=3-注释>3. 注释<a hidden class=anchor aria-hidden=true href=#3-注释>#</a></h2><p>要想让<code>sqlc</code>为你生成代码，需要在查询语句的上方写上一行注释，其格式为：</p><pre><code>-- name: &lt;name&gt; &lt;command&gt;
</code></pre><p>其中, 是你想要生成函数的名字，则是对生成函数的返回做简单的设置</p><ol><li><code>:exec</code></li></ol><p><code>:exec</code>使函数只执行查询语句，但不返回任何值（除error外）</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#75715e>-- name: DeleteAuthor :exec
</span><span style=color:#75715e></span><span style=color:#66d9ef>DELETE</span> <span style=color:#66d9ef>FROM</span> authors
<span style=color:#66d9ef>WHERE</span> id <span style=color:#f92672>=</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#ae81ff>1</span>;
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>q</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>Queries</span>) <span style=color:#a6e22e>DeleteAuthor</span>(<span style=color:#a6e22e>ctx</span> <span style=color:#a6e22e>context</span>.<span style=color:#a6e22e>Context</span>, <span style=color:#a6e22e>id</span> <span style=color:#66d9ef>int64</span>) <span style=color:#66d9ef>error</span> {
  <span style=color:#a6e22e>_</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>q</span>.<span style=color:#a6e22e>db</span>.<span style=color:#a6e22e>ExecContext</span>(<span style=color:#a6e22e>ctx</span>, <span style=color:#a6e22e>deleteAuthor</span>, <span style=color:#a6e22e>id</span>)
  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>err</span>
}
</code></pre></div><ol start=2><li><code>:execresult</code>
<code>:execresult</code>使函数返回一个<code>sql.Result</code>接口，其接口定义如下：</li></ol><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>Result</span> <span style=color:#66d9ef>interface</span> {
	<span style=color:#75715e>// LastInsertId returns the integer generated by the database
</span><span style=color:#75715e></span>	<span style=color:#75715e>// in response to a command. Typically this will be from an
</span><span style=color:#75715e></span>	<span style=color:#75715e>// &#34;auto increment&#34; column when inserting a new row. Not all
</span><span style=color:#75715e></span>	<span style=color:#75715e>// databases support this feature, and the syntax of such
</span><span style=color:#75715e></span>	<span style=color:#75715e>// statements varies.
</span><span style=color:#75715e></span>	<span style=color:#a6e22e>LastInsertId</span>() (<span style=color:#66d9ef>int64</span>, <span style=color:#66d9ef>error</span>)

	<span style=color:#75715e>// RowsAffected returns the number of rows affected by an
</span><span style=color:#75715e></span>	<span style=color:#75715e>// update, insert, or delete. Not every database or database
</span><span style=color:#75715e></span>	<span style=color:#75715e>// driver may support this.
</span><span style=color:#75715e></span>	<span style=color:#a6e22e>RowsAffected</span>() (<span style=color:#66d9ef>int64</span>, <span style=color:#66d9ef>error</span>)
}
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#75715e>-- name: DeleteAllAuthors :execresult
</span><span style=color:#75715e></span><span style=color:#66d9ef>DELETE</span> <span style=color:#66d9ef>FROM</span> authors;
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>q</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>Queries</span>) <span style=color:#a6e22e>DeleteAllAuthors</span>(<span style=color:#a6e22e>ctx</span> <span style=color:#a6e22e>context</span>.<span style=color:#a6e22e>Context</span>) (<span style=color:#a6e22e>sql</span>.<span style=color:#a6e22e>Result</span>, <span style=color:#66d9ef>error</span>) {
  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>q</span>.<span style=color:#a6e22e>db</span>.<span style=color:#a6e22e>ExecContext</span>(<span style=color:#a6e22e>ctx</span>, <span style=color:#a6e22e>deleteAllAuthors</span>)
}
</code></pre></div><ol start=3><li><code>:execrows</code>
<code>:execrows</code>使函数返回受该查询语句影响的行</li></ol><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#75715e>-- name: DeleteAllAuthors :execrows
</span><span style=color:#75715e></span><span style=color:#66d9ef>DELETE</span> <span style=color:#66d9ef>FROM</span> authors;
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>q</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>Queries</span>) <span style=color:#a6e22e>DeleteAllAuthors</span>(<span style=color:#a6e22e>ctx</span> <span style=color:#a6e22e>context</span>.<span style=color:#a6e22e>Context</span>) (<span style=color:#66d9ef>int64</span>, <span style=color:#66d9ef>error</span>) {
  <span style=color:#a6e22e>_</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>q</span>.<span style=color:#a6e22e>db</span>.<span style=color:#a6e22e>ExecContext</span>(<span style=color:#a6e22e>ctx</span>, <span style=color:#a6e22e>deleteAllAuthors</span>)
  <span style=color:#75715e>// ...
</span><span style=color:#75715e></span>}
</code></pre></div><ol start=4><li><code>:many</code>
<code>:many</code>使函数返回一个切片</li></ol><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#75715e>-- name: ListAuthors :many
</span><span style=color:#75715e></span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> authors
<span style=color:#66d9ef>ORDER</span> <span style=color:#66d9ef>BY</span> name;
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>q</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>Queries</span>) <span style=color:#a6e22e>ListAuthors</span>(<span style=color:#a6e22e>ctx</span> <span style=color:#a6e22e>context</span>.<span style=color:#a6e22e>Context</span>) ([]<span style=color:#a6e22e>Author</span>, <span style=color:#66d9ef>error</span>) {
  <span style=color:#a6e22e>rows</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>q</span>.<span style=color:#a6e22e>db</span>.<span style=color:#a6e22e>QueryContext</span>(<span style=color:#a6e22e>ctx</span>, <span style=color:#a6e22e>listAuthors</span>)
  <span style=color:#75715e>// ...
</span><span style=color:#75715e></span>}
</code></pre></div><ol start=5><li><code>:one</code>
<code>:one</code>使函数返回单个对象</li></ol><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#75715e>-- name: GetAuthor :one
</span><span style=color:#75715e></span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> authors
<span style=color:#66d9ef>WHERE</span> id <span style=color:#f92672>=</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#ae81ff>1</span> <span style=color:#66d9ef>LIMIT</span> <span style=color:#ae81ff>1</span>;
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>q</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>Queries</span>) <span style=color:#a6e22e>GetAuthor</span>(<span style=color:#a6e22e>ctx</span> <span style=color:#a6e22e>context</span>.<span style=color:#a6e22e>Context</span>, <span style=color:#a6e22e>id</span> <span style=color:#66d9ef>int64</span>) (<span style=color:#a6e22e>Author</span>, <span style=color:#66d9ef>error</span>) {
  <span style=color:#a6e22e>row</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>q</span>.<span style=color:#a6e22e>db</span>.<span style=color:#a6e22e>QueryRowContext</span>(<span style=color:#a6e22e>ctx</span>, <span style=color:#a6e22e>getAuthor</span>, <span style=color:#a6e22e>id</span>)
  <span style=color:#75715e>// ...
</span><span style=color:#75715e></span>}
</code></pre></div><h2 id=4-配置文件>4. 配置文件<a hidden class=anchor aria-hidden=true href=#4-配置文件>#</a></h2><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#f92672>version</span>: <span style=color:#e6db74>&#34;1&#34;</span>
<span style=color:#f92672>packages</span>:
  - <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;db&#34;</span> <span style=color:#75715e># 生成代码的包名</span>
    <span style=color:#f92672>path</span>: <span style=color:#e6db74>&#34;internal/db&#34;</span> <span style=color:#75715e># 生成代码的位置</span>
    <span style=color:#f92672>queries</span>: <span style=color:#e6db74>&#34;./sql/query/&#34;</span> <span style=color:#75715e># 查询语句的位置</span>
    <span style=color:#f92672>schema</span>: <span style=color:#e6db74>&#34;./sql/schema/&#34;</span> <span style=color:#75715e># 数据库表的位置</span>
    <span style=color:#f92672>engine</span>: <span style=color:#e6db74>&#34;postgresql&#34;</span> <span style=color:#75715e># 数据库引擎</span>
    <span style=color:#f92672>emit_prepared_queries</span>: <span style=color:#66d9ef>true</span> <span style=color:#75715e># 开启预查询支持，默认为false</span>
    <span style=color:#f92672>emit_interface</span>: <span style=color:#66d9ef>false</span> <span style=color:#75715e># 如果为true，则会生成一个Querier接口，包含所有查询方法，默认为false</span>
    <span style=color:#f92672>emit_exact_table_names</span>: <span style=color:#66d9ef>false</span> <span style=color:#75715e># 如果为true，则结构体会与表名相同，否则将会对复数表名进行单数化，默认为false</span>
    <span style=color:#f92672>emit_empty_slices</span>: <span style=color:#66d9ef>false</span> <span style=color:#75715e># 如果为true，则:many标签若查询为空会返回[]而不是nil, 默认为false</span>
    <span style=color:#f92672>emit_exported_queries</span>: <span style=color:#66d9ef>false</span> <span style=color:#75715e># 如果为true，则生成的函数为可导出的</span>
    <span style=color:#f92672>emit_json_tags</span>: <span style=color:#66d9ef>true</span> <span style=color:#75715e># 如果为true，则为生成的结构体增加json标签</span>
    <span style=color:#f92672>json_tags_case_style</span>: <span style=color:#f92672>&#34;camel&#34; # json标签的风格，&#34;camel&#34;：camelCase，&#34;pascal&#34;:PascalCase, &#34;snake&#34;: </span><span style=color:#ae81ff>snake_case</span>
    <span style=color:#f92672>output_db_file_name</span>: <span style=color:#e6db74>&#34;db.go&#34;</span> <span style=color:#75715e># 自定义db文件的名字</span>
    <span style=color:#f92672>output_models_file_name</span>: <span style=color:#e6db74>&#34;models.go&#34;</span> <span style=color:#75715e># 自定义model文件的名字</span>
    <span style=color:#f92672>output_querier_file_name</span>: <span style=color:#e6db74>&#34;querier.go&#34;</span> <span style=color:#75715e># 自定义querier文件的名字</span>
</code></pre></div></div><footer class=post-footer><ul class=post-tags><li><a href=http://yangchnet.github.io/Dessert/tags/golang/>golang</a></li><li><a href=http://yangchnet.github.io/Dessert/tags/orm/>ORM</a></li><li><a href=http://yangchnet.github.io/Dessert/tags/sqlc/>sqlc</a></li></ul><nav class=paginav><a class=prev href=http://yangchnet.github.io/Dessert/posts/linux/vim%E9%85%8D%E7%BD%AE/><span class=title>« Prev Page</span><br><span>vim配置</span></a>
<a class=next href=http://yangchnet.github.io/Dessert/posts/golang/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%89%88%E6%9C%AC%E7%AE%A1%E7%90%86-migrate/><span class=title>Next Page »</span><br><span>数据库版本管理-migrate</span></a></nav><div class=share-buttons><div class=bshare-custom><a title=分享到微信 class=bshare-weixin></a><a title=分享到QQ好友 class=bshare-qqim></a><a title=分享到复制网址 class=bshare-clipboard></a><a title=分享到QQ空间 class=bshare-qzone></a><a title=分享到新浪微博 class=bshare-sinaminiblog></a><a title=分享到电子邮件 class=bshare-email></a><a title=更多平台 class="bshare-more bshare-more-icon more-style-addthis"></a></div><script type=text/javascript src="http://static.bshare.cn/b/buttonLite.js#style=-1&uuid=&pophcol=2&lang=zh"></script><script type=text/javascript src=http://static.bshare.cn/b/bshareC0.js></script></div></footer></article></main><footer class=footer><span>&copy; 2021 <a href=http://yangchnet.github.io/Dessert>Linote</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span>
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0-rc.1/katex.min.css><script src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0-rc.1/katex.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0-rc.1/contrib/auto-render.min.js></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]})})</script></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>let menu=document.getElementById('menu');menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script></body></html>